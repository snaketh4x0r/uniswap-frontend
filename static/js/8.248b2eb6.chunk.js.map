{"version":3,"sources":["components/ContextualInfo/index.js","assets/images/plus-blue.svg","pages/Pool/AddLiquidity.js"],"names":["SummaryWrapper","styled","div","error","theme","salmonRed","doveGray","Details","concreteGray","SummaryWrapperContainer","flexRowNoWrap","royalBlue","ColoredDropup","isError","highSlippageWarning","rest","ColoredDropdown","ContextualInfo","state","showDetails","this","props","renderTransactionDetails","openDetailsText","closeDetailsText","contextualInfo","onClick","setState","prevState","renderDetails","Component","defaultProps","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref2","createElement","d","stroke","strokeLinecap","_ref","svgRef","title","width","height","viewBox","fill","ref","ForwardRef","forwardRef","INPUT","OUTPUT","ALLOWED_SLIPPAGE","ethers","utils","bigNumberify","DEADLINE_FROM_NOW","GAS_MARGIN","BlueSpan","span","NewExchangeWarning","NewExchangeWarningText","LastSummaryText","DownArrowBackground","SummaryPanel","flexColumnNoWrap","ExchangeRateWrapper","ExchangeRate","Flex","ColoredWrappedPlus","active","chaliceGray","calculateSlippageBounds","value","offset","mul","minimum","sub","maximum","add","lt","constants","Zero","gt","MaxUint256","initialAddLiquidityState","inputValue","outputValue","lastEditedField","outputCurrency","addLiquidityStateReducer","action","type","payload","field","getMarketRate","reserveETH","reserveToken","decimals","inputDecimals","outputDecimals","invert","factor","pow","getExchangeRate","AddLiquidity","t","useTranslation","useWeb3Context","library","account","useReducer","addLiquidityState","dispatchAddLiquidityState","inputCurrency","useState","inputValueParsed","setInputValueParsed","outputValueParsed","setOutputValueParsed","inputError","setInputError","outputError","setOutputError","useTokenDetails","symbol","exchangeAddress","exchangeContract","useExchangeContract","totalPoolTokens","setTotalPoolTokens","fetchPoolTokens","useCallback","totalSupply","then","useEffect","on","removeListener","poolTokenBalance","useAddressBalance","exchangeETHBalance","exchangeTokenBalance","useExchangeReserves","isNewExchange","isZero","poolTokenPercentage","undefined","ethShare","tokenShare","liquidityMinted","inputBalance","outputBalance","ethPerLiquidityToken","tokenPerLiquidityToken","outputValueMax","liquidityTokensMin","marketRate","useMemo","marketRateInverted","ReactGA","event","category","b","text","amountFormatter","Math","min","addTransaction","useTransactionAdder","a","deadline","ceil","Date","now","estimate","addLiquidity","estimatedGasLimit","gasLimit","calculateGasMargin","response","formatBalance","parsedInputValue","parseUnits","parsedOutputValue","parsedValue","lte","gte","Error","currencyAmount","allowance","useAddressAllowance","showUnlock","setShowUnlock","isActive","isValid","allBalances","useFetchAllBalances","role","aria-label","CurrencyInputPanel","extraText","onValueChange","selectedTokenAddress","errorMessage","disableTokenSelect","OversizedPanel","alt","description","onCurrencySelected","hideBottom","renderSummary","disabled"],"mappings":"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","file":"static/js/8.248b2eb6.chunk.js","sourcesContent":["import React, { Component } from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport styled from 'styled-components'\r\n\r\nimport { ReactComponent as Dropup } from '../../assets/images/dropup-blue.svg'\r\nimport { ReactComponent as Dropdown } from '../../assets/images/dropdown-blue.svg'\r\n\r\nconst SummaryWrapper = styled.div`\r\n  color: ${({ error, theme }) => (error ? theme.salmonRed : theme.doveGray)};\r\n  font-size: 0.75rem;\r\n  text-align: center;\r\n  margin-top: 1rem;\r\n  padding-top: 1rem;\r\n`\r\n\r\nconst Details = styled.div`\r\n  background-color: ${({ theme }) => theme.concreteGray};\r\n  padding: 1.5rem;\r\n  border-radius: 1rem;\r\n  font-size: 0.75rem;\r\n  margin-top: 1rem;\r\n`\r\n\r\nconst SummaryWrapperContainer = styled.div`\r\n  ${({ theme }) => theme.flexRowNoWrap};\r\n  color: ${({ theme }) => theme.royalBlue};\r\n  text-align: center;\r\n  margin-top: 1rem;\r\n  padding-top: 1rem;\r\n  cursor: pointer;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 0.75rem;\r\n\r\n  span {\r\n    margin-right: 12px;\r\n  }\r\n\r\n  img {\r\n    height: 0.75rem;\r\n    width: 0.75rem;\r\n  }\r\n`\r\n\r\nconst WrappedDropup = ({ isError, highSlippageWarning, ...rest }) => <Dropup {...rest} />\r\nconst ColoredDropup = styled(WrappedDropup)`\r\n  path {\r\n    stroke: ${({ theme }) => theme.royalBlue};\r\n  }\r\n`\r\n\r\nconst WrappedDropdown = ({ isError, highSlippageWarning, ...rest }) => <Dropdown {...rest} />\r\nconst ColoredDropdown = styled(WrappedDropdown)`\r\n  path {\r\n    stroke: ${({ theme }) => theme.royalBlue};\r\n  }\r\n`\r\n\r\nclass ContextualInfo extends Component {\r\n  static propTypes = {\r\n    openDetailsText: PropTypes.string,\r\n    renderTransactionDetails: PropTypes.func,\r\n    contextualInfo: PropTypes.string,\r\n    isError: PropTypes.bool\r\n  }\r\n\r\n  static defaultProps = {\r\n    openDetailsText: 'Advanced Details',\r\n    closeDetailsText: 'Hide Advanced',\r\n    renderTransactionDetails() {},\r\n    contextualInfo: '',\r\n    isError: false\r\n  }\r\n\r\n  state = {\r\n    showDetails: false\r\n  }\r\n\r\n  renderDetails() {\r\n    if (!this.state.showDetails) {\r\n      return null\r\n    }\r\n\r\n    return <Details>{this.props.renderTransactionDetails()}</Details>\r\n  }\r\n\r\n  render() {\r\n    const { openDetailsText, closeDetailsText, contextualInfo, isError } = this.props\r\n\r\n    if (contextualInfo) {\r\n      return <SummaryWrapper error={isError}>{contextualInfo}</SummaryWrapper>\r\n    }\r\n\r\n    return (\r\n      <>\r\n        <SummaryWrapperContainer\r\n          onClick={() =>\r\n            this.setState(prevState => {\r\n              return { showDetails: !prevState.showDetails }\r\n            })\r\n          }\r\n        >\r\n          {!this.state.showDetails ? (\r\n            <>\r\n              <span>{openDetailsText}</span>\r\n              <ColoredDropup />\r\n            </>\r\n          ) : (\r\n            <>\r\n              <span>{closeDetailsText}</span>\r\n              <ColoredDropdown />\r\n            </>\r\n          )}\r\n        </SummaryWrapperContainer>\r\n        {this.renderDetails()}\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default ContextualInfo\r\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M1 6H6M11 6L6 6M6 1V6M6 6L6 11\",\n  stroke: \"#2F80ED\",\n  strokeLinecap: \"round\"\n});\n\nvar SvgPlusBlue = function SvgPlusBlue(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 12,\n    height: 12,\n    viewBox: \"0 0 12 12\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), React.createElement(\"title\", null, title), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgPlusBlue, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/plus-blue.899a4aa9.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useReducer, useState, useCallback, useEffect, useMemo } from 'react'\r\nimport { useTranslation } from 'react-i18next'\r\nimport { useWeb3Context } from 'web3-react'\r\nimport { ethers } from 'ethers'\r\nimport ReactGA from 'react-ga'\r\nimport styled from 'styled-components'\r\n\r\nimport { Button } from '../../theme'\r\nimport CurrencyInputPanel from '../../components/CurrencyInputPanel'\r\nimport OversizedPanel from '../../components/OversizedPanel'\r\nimport ContextualInfo from '../../components/ContextualInfo'\r\nimport { ReactComponent as Plus } from '../../assets/images/plus-blue.svg'\r\n\r\nimport { useExchangeContract } from '../../hooks'\r\nimport { amountFormatter, calculateGasMargin } from '../../utils'\r\nimport { useTransactionAdder } from '../../contexts/Transactions'\r\nimport { useTokenDetails } from '../../contexts/Tokens'\r\nimport { useFetchAllBalances } from '../../contexts/AllBalances'\r\nimport { useAddressBalance, useExchangeReserves } from '../../contexts/Balances'\r\nimport { useAddressAllowance } from '../../contexts/Allowances'\r\n\r\nconst INPUT = 0\r\nconst OUTPUT = 1\r\n\r\n// denominated in bips\r\nconst ALLOWED_SLIPPAGE = ethers.utils.bigNumberify(200)\r\n\r\n// denominated in seconds\r\nconst DEADLINE_FROM_NOW = 60 * 15\r\n\r\n// denominated in bips\r\nconst GAS_MARGIN = ethers.utils.bigNumberify(1000)\r\n\r\nconst BlueSpan = styled.span`\r\n  color: ${({ theme }) => theme.royalBlue};\r\n`\r\n\r\nconst NewExchangeWarning = styled.div`\r\n  margin-top: 1rem;\r\n  padding: 1rem;\r\n  margin-bottom: 2rem;\r\n  border: 1px solid rgba($pizazz-orange, 0.4);\r\n  background-color: rgba($pizazz-orange, 0.1);\r\n  border-radius: 1rem;\r\n`\r\n\r\nconst NewExchangeWarningText = styled.div`\r\n  font-size: 0.75rem;\r\n  line-height: 1rem;\r\n  text-align: center;\r\n\r\n  :first-child {\r\n    padding-bottom: 0.3rem;\r\n    font-weight: 500;\r\n  }\r\n`\r\n\r\nconst LastSummaryText = styled.div`\r\n  margin-top: 1rem;\r\n`\r\n\r\nconst DownArrowBackground = styled.div`\r\n  ${({ theme }) => theme.flexRowNoWrap}\r\n  justify-content: center;\r\n  align-items: center;\r\n`\r\nconst SummaryPanel = styled.div`\r\n  ${({ theme }) => theme.flexColumnNoWrap}\r\n  padding: 1rem 0;\r\n`\r\n\r\nconst ExchangeRateWrapper = styled.div`\r\n  ${({ theme }) => theme.flexRowNoWrap};\r\n  align-items: center;\r\n  color: ${({ theme }) => theme.doveGray};\r\n  font-size: 0.75rem;\r\n  padding: 0.25rem 1rem 0;\r\n`\r\n\r\nconst ExchangeRate = styled.span`\r\n  flex: 1 1 auto;\r\n  width: 0;\r\n  color: ${({ theme }) => theme.doveGray};\r\n`\r\n\r\nconst Flex = styled.div`\r\n  display: flex;\r\n  justify-content: center;\r\n  padding: 2rem;\r\n\r\n  button {\r\n    max-width: 20rem;\r\n  }\r\n`\r\n\r\nconst WrappedPlus = ({ isError, highSlippageWarning, ...rest }) => <Plus {...rest} />\r\nconst ColoredWrappedPlus = styled(WrappedPlus)`\r\n  width: 0.625rem;\r\n  height: 0.625rem;\r\n  position: relative;\r\n  padding: 0.875rem;\r\n  path {\r\n    stroke: ${({ active, theme }) => (active ? theme.royalBlue : theme.chaliceGray)};\r\n  }\r\n`\r\n\r\nfunction calculateSlippageBounds(value) {\r\n  if (value) {\r\n    const offset = value.mul(ALLOWED_SLIPPAGE).div(ethers.utils.bigNumberify(10000))\r\n    const minimum = value.sub(offset)\r\n    const maximum = value.add(offset)\r\n    return {\r\n      minimum: minimum.lt(ethers.constants.Zero) ? ethers.constants.Zero : minimum,\r\n      maximum: maximum.gt(ethers.constants.MaxUint256) ? ethers.constants.MaxUint256 : maximum\r\n    }\r\n  } else {\r\n    return {}\r\n  }\r\n}\r\n\r\nconst initialAddLiquidityState = {\r\n  inputValue: '',\r\n  outputValue: '',\r\n  lastEditedField: INPUT,\r\n  outputCurrency: ''\r\n}\r\n\r\nfunction addLiquidityStateReducer(state, action) {\r\n  switch (action.type) {\r\n    case 'SELECT_CURRENCY': {\r\n      return {\r\n        ...state,\r\n        outputCurrency: action.payload\r\n      }\r\n    }\r\n    case 'UPDATE_VALUE': {\r\n      const { inputValue, outputValue } = state\r\n      const { field, value } = action.payload\r\n      return {\r\n        ...state,\r\n        inputValue: field === INPUT ? value : inputValue,\r\n        outputValue: field === OUTPUT ? value : outputValue,\r\n        lastEditedField: field\r\n      }\r\n    }\r\n    case 'UPDATE_DEPENDENT_VALUE': {\r\n      const { inputValue, outputValue } = state\r\n      const { field, value } = action.payload\r\n      return {\r\n        ...state,\r\n        inputValue: field === INPUT ? value : inputValue,\r\n        outputValue: field === OUTPUT ? value : outputValue\r\n      }\r\n    }\r\n    default: {\r\n      return initialAddLiquidityState\r\n    }\r\n  }\r\n}\r\n\r\nfunction getExchangeRate(inputValue, inputDecimals, outputValue, outputDecimals, invert = false) {\r\n  try {\r\n    if (\r\n      inputValue &&\r\n      (inputDecimals || inputDecimals === 0) &&\r\n      outputValue &&\r\n      (outputDecimals || outputDecimals === 0)\r\n    ) {\r\n      const factor = ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18))\r\n\r\n      if (invert) {\r\n        return inputValue\r\n          .mul(factor)\r\n          .div(outputValue)\r\n          .mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(outputDecimals)))\r\n          .div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(inputDecimals)))\r\n      } else {\r\n        return outputValue\r\n          .mul(factor)\r\n          .div(inputValue)\r\n          .mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(inputDecimals)))\r\n          .div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(outputDecimals)))\r\n      }\r\n    }\r\n  } catch {}\r\n}\r\n\r\nfunction getMarketRate(reserveETH, reserveToken, decimals, invert = false) {\r\n  return getExchangeRate(reserveETH, 18, reserveToken, decimals, invert)\r\n}\r\n\r\nexport default function AddLiquidity() {\r\n  const { t } = useTranslation()\r\n  const { library, active, account } = useWeb3Context()\r\n\r\n  const [addLiquidityState, dispatchAddLiquidityState] = useReducer(addLiquidityStateReducer, initialAddLiquidityState)\r\n  const { inputValue, outputValue, lastEditedField, outputCurrency } = addLiquidityState\r\n  const inputCurrency = 'ETH'\r\n\r\n  const [inputValueParsed, setInputValueParsed] = useState()\r\n  const [outputValueParsed, setOutputValueParsed] = useState()\r\n  const [inputError, setInputError] = useState()\r\n  const [outputError, setOutputError] = useState()\r\n\r\n  const { symbol, decimals, exchangeAddress } = useTokenDetails(outputCurrency)\r\n  const exchangeContract = useExchangeContract(exchangeAddress)\r\n\r\n  const [totalPoolTokens, setTotalPoolTokens] = useState()\r\n  const fetchPoolTokens = useCallback(() => {\r\n    if (exchangeContract) {\r\n      exchangeContract.totalSupply().then(totalSupply => {\r\n        setTotalPoolTokens(totalSupply)\r\n      })\r\n    }\r\n  }, [exchangeContract])\r\n  useEffect(() => {\r\n    fetchPoolTokens()\r\n    library.on('block', fetchPoolTokens)\r\n\r\n    return () => {\r\n      library.removeListener('block', fetchPoolTokens)\r\n    }\r\n  }, [fetchPoolTokens, library])\r\n\r\n  const poolTokenBalance = useAddressBalance(account, exchangeAddress)\r\n  const exchangeETHBalance = useAddressBalance(exchangeAddress, 'ETH')\r\n  const exchangeTokenBalance = useAddressBalance(exchangeAddress, outputCurrency)\r\n\r\n  const { reserveETH, reserveToken } = useExchangeReserves(outputCurrency)\r\n  const isNewExchange = !!(reserveETH && reserveToken && reserveETH.isZero() && reserveToken.isZero())\r\n\r\n  // 18 decimals\r\n  const poolTokenPercentage =\r\n    poolTokenBalance && totalPoolTokens && isNewExchange === false && !totalPoolTokens.isZero()\r\n      ? poolTokenBalance.mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18))).div(totalPoolTokens)\r\n      : undefined\r\n  const ethShare =\r\n    exchangeETHBalance && poolTokenPercentage\r\n      ? exchangeETHBalance\r\n          .mul(poolTokenPercentage)\r\n          .div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18)))\r\n      : undefined\r\n  const tokenShare =\r\n    exchangeTokenBalance && poolTokenPercentage\r\n      ? exchangeTokenBalance\r\n          .mul(poolTokenPercentage)\r\n          .div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18)))\r\n      : undefined\r\n\r\n  const liquidityMinted = isNewExchange\r\n    ? inputValueParsed\r\n    : totalPoolTokens && inputValueParsed && exchangeETHBalance && !exchangeETHBalance.isZero()\r\n    ? totalPoolTokens.mul(inputValueParsed).div(exchangeETHBalance)\r\n    : undefined\r\n\r\n  // user balances\r\n  const inputBalance = useAddressBalance(account, inputCurrency)\r\n  const outputBalance = useAddressBalance(account, outputCurrency)\r\n\r\n  const ethPerLiquidityToken =\r\n    exchangeETHBalance && totalPoolTokens && isNewExchange === false && !totalPoolTokens.isZero()\r\n      ? exchangeETHBalance.mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18))).div(totalPoolTokens)\r\n      : undefined\r\n  const tokenPerLiquidityToken =\r\n    exchangeTokenBalance && totalPoolTokens && isNewExchange === false && !totalPoolTokens.isZero()\r\n      ? exchangeTokenBalance.mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18))).div(totalPoolTokens)\r\n      : undefined\r\n\r\n  const outputValueMax = outputValueParsed && calculateSlippageBounds(outputValueParsed).maximum\r\n  const liquidityTokensMin = liquidityMinted && calculateSlippageBounds(liquidityMinted).minimum\r\n\r\n  const marketRate = useMemo(() => {\r\n    return getMarketRate(reserveETH, reserveToken, decimals)\r\n  }, [reserveETH, reserveToken, decimals])\r\n  const marketRateInverted = useMemo(() => {\r\n    return getMarketRate(reserveETH, reserveToken, decimals, true)\r\n  }, [reserveETH, reserveToken, decimals])\r\n\r\n  function renderTransactionDetails() {\r\n    ReactGA.event({\r\n      category: 'TransactionDetail',\r\n      action: 'Open'\r\n    })\r\n\r\n    const b = text => <BlueSpan>{text}</BlueSpan>\r\n\r\n    if (isNewExchange) {\r\n      return (\r\n        <div>\r\n          <div>\r\n            {t('youAreAdding')} {b(`${inputValue} ETH`)} {t('and')} {b(`${outputValue} ${symbol}`)} {t('intoPool')}\r\n          </div>\r\n          <LastSummaryText>\r\n            {t('youAreSettingExRate')}{' '}\r\n            {b(\r\n              `1 ETH = ${amountFormatter(\r\n                getMarketRate(inputValueParsed, outputValueParsed, decimals),\r\n                18,\r\n                4,\r\n                false\r\n              )} ${symbol}`\r\n            )}\r\n            .\r\n          </LastSummaryText>\r\n          <LastSummaryText>\r\n            {t('youWillMint')} {b(`${inputValue}`)} {t('liquidityTokens')}\r\n          </LastSummaryText>\r\n          <LastSummaryText>{t('totalSupplyIs0')}</LastSummaryText>\r\n        </div>\r\n      )\r\n    } else {\r\n      return (\r\n        <>\r\n          <div>\r\n            {t('youAreAdding')} {b(`${amountFormatter(inputValueParsed, 18, 4)} ETH`)} {t('and')} {'at most'}{' '}\r\n            {b(`${amountFormatter(outputValueMax, decimals, Math.min(decimals, 4))} ${symbol}`)} {t('intoPool')}\r\n          </div>\r\n          <LastSummaryText>\r\n            {t('youWillMint')} {b(amountFormatter(liquidityMinted, 18, 4))} {t('liquidityTokens')}\r\n          </LastSummaryText>\r\n          <LastSummaryText>\r\n            {t('totalSupplyIs')} {b(amountFormatter(totalPoolTokens, 18, 4))}\r\n          </LastSummaryText>\r\n          <LastSummaryText>\r\n            {t('tokenWorth')} {b(amountFormatter(ethPerLiquidityToken, 18, 4))} ETH {t('and')}{' '}\r\n            {b(amountFormatter(tokenPerLiquidityToken, decimals, Math.min(decimals, 4)))} {symbol}\r\n          </LastSummaryText>\r\n        </>\r\n      )\r\n    }\r\n  }\r\n\r\n  function renderSummary() {\r\n    let contextualInfo = ''\r\n    let isError = false\r\n\r\n    if (inputError || outputError) {\r\n      contextualInfo = inputError || outputError\r\n      isError = true\r\n    } else if (!inputCurrency || !outputCurrency) {\r\n      contextualInfo = t('selectTokenCont')\r\n    } else if (!inputValue) {\r\n      contextualInfo = t('enterValueCont')\r\n    } else if (!account) {\r\n      contextualInfo = t('noWallet')\r\n      isError = true\r\n    }\r\n\r\n    return (\r\n      <ContextualInfo\r\n        openDetailsText={t('transactionDetails')}\r\n        closeDetailsText={t('hideDetails')}\r\n        contextualInfo={contextualInfo}\r\n        isError={isError}\r\n        renderTransactionDetails={renderTransactionDetails}\r\n      />\r\n    )\r\n  }\r\n\r\n  const addTransaction = useTransactionAdder()\r\n\r\n  async function onAddLiquidity() {\r\n    ReactGA.event({\r\n      category: 'Pool',\r\n      action: 'AddLiquidity'\r\n    })\r\n\r\n    const deadline = Math.ceil(Date.now() / 1000) + DEADLINE_FROM_NOW\r\n\r\n    const estimatedGasLimit = await exchangeContract.estimate.addLiquidity(\r\n      isNewExchange ? ethers.constants.Zero : liquidityTokensMin,\r\n      isNewExchange ? outputValueParsed : outputValueMax,\r\n      deadline,\r\n      {\r\n        value: inputValueParsed\r\n      }\r\n    )\r\n\r\n    const gasLimit = calculateGasMargin(estimatedGasLimit, GAS_MARGIN)\r\n\r\n    exchangeContract\r\n      .addLiquidity(\r\n        isNewExchange ? ethers.constants.Zero : liquidityTokensMin,\r\n        isNewExchange ? outputValueParsed : outputValueMax,\r\n        deadline,\r\n        {\r\n          value: inputValueParsed,\r\n          gasLimit\r\n        }\r\n      )\r\n      .then(response => {\r\n        addTransaction(response)\r\n      })\r\n  }\r\n\r\n  function formatBalance(value) {\r\n    return `Balance: ${value}`\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (isNewExchange) {\r\n      if (inputValue) {\r\n        const parsedInputValue = ethers.utils.parseUnits(inputValue, 18)\r\n        setInputValueParsed(parsedInputValue)\r\n      }\r\n\r\n      if (outputValue) {\r\n        const parsedOutputValue = ethers.utils.parseUnits(outputValue, decimals)\r\n        setOutputValueParsed(parsedOutputValue)\r\n      }\r\n    }\r\n  }, [decimals, inputValue, isNewExchange, outputValue])\r\n\r\n  // parse input value\r\n  useEffect(() => {\r\n    if (\r\n      isNewExchange === false &&\r\n      inputValue &&\r\n      marketRate &&\r\n      lastEditedField === INPUT &&\r\n      (decimals || decimals === 0)\r\n    ) {\r\n      try {\r\n        const parsedValue = ethers.utils.parseUnits(inputValue, 18)\r\n\r\n        if (parsedValue.lte(ethers.constants.Zero) || parsedValue.gte(ethers.constants.MaxUint256)) {\r\n          throw Error()\r\n        }\r\n\r\n        setInputValueParsed(parsedValue)\r\n\r\n        const currencyAmount = marketRate\r\n          .mul(parsedValue)\r\n          .div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18)))\r\n          .div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18 - decimals)))\r\n\r\n        setOutputValueParsed(currencyAmount)\r\n        dispatchAddLiquidityState({\r\n          type: 'UPDATE_DEPENDENT_VALUE',\r\n          payload: { field: OUTPUT, value: amountFormatter(currencyAmount, decimals, Math.min(decimals, 4), false) }\r\n        })\r\n\r\n        return () => {\r\n          setOutputError()\r\n          setInputValueParsed()\r\n          setOutputValueParsed()\r\n          dispatchAddLiquidityState({\r\n            type: 'UPDATE_DEPENDENT_VALUE',\r\n            payload: { field: OUTPUT, value: '' }\r\n          })\r\n        }\r\n      } catch {\r\n        setOutputError(t('inputNotValid'))\r\n      }\r\n    }\r\n  }, [inputValue, isNewExchange, lastEditedField, marketRate, decimals, t])\r\n\r\n  // parse output value\r\n  useEffect(() => {\r\n    if (\r\n      isNewExchange === false &&\r\n      outputValue &&\r\n      marketRateInverted &&\r\n      lastEditedField === OUTPUT &&\r\n      (decimals || decimals === 0)\r\n    ) {\r\n      try {\r\n        const parsedValue = ethers.utils.parseUnits(outputValue, decimals)\r\n\r\n        if (parsedValue.lte(ethers.constants.Zero) || parsedValue.gte(ethers.constants.MaxUint256)) {\r\n          throw Error()\r\n        }\r\n\r\n        setOutputValueParsed(parsedValue)\r\n\r\n        const currencyAmount = marketRateInverted\r\n          .mul(parsedValue)\r\n          .div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(decimals)))\r\n\r\n        setInputValueParsed(currencyAmount)\r\n        dispatchAddLiquidityState({\r\n          type: 'UPDATE_DEPENDENT_VALUE',\r\n          payload: { field: INPUT, value: amountFormatter(currencyAmount, 18, 4, false) }\r\n        })\r\n\r\n        return () => {\r\n          setInputError()\r\n          setOutputValueParsed()\r\n          setInputValueParsed()\r\n          dispatchAddLiquidityState({\r\n            type: 'UPDATE_DEPENDENT_VALUE',\r\n            payload: { field: INPUT, value: '' }\r\n          })\r\n        }\r\n      } catch {\r\n        setInputError(t('inputNotValid'))\r\n      }\r\n    }\r\n  }, [outputValue, isNewExchange, lastEditedField, marketRateInverted, decimals, t])\r\n\r\n  // input validation\r\n  useEffect(() => {\r\n    if (inputValueParsed && inputBalance) {\r\n      if (inputValueParsed.gt(inputBalance)) {\r\n        setInputError(t('insufficientBalance'))\r\n      } else {\r\n        setInputError(null)\r\n      }\r\n    }\r\n\r\n    if (outputValueMax && outputBalance) {\r\n      if (outputValueMax.gt(outputBalance)) {\r\n        setOutputError(t('insufficientBalance'))\r\n      } else {\r\n        setOutputError(null)\r\n      }\r\n    }\r\n  }, [inputValueParsed, inputBalance, outputValueMax, outputBalance, t])\r\n\r\n  const allowance = useAddressAllowance(account, outputCurrency, exchangeAddress)\r\n  const [showUnlock, setShowUnlock] = useState(false)\r\n  useEffect(() => {\r\n    if (outputValueParsed && allowance) {\r\n      if (allowance.lt(outputValueParsed)) {\r\n        setOutputError(t('unlockTokenCont'))\r\n        setShowUnlock(true)\r\n      }\r\n      return () => {\r\n        setOutputError()\r\n        setShowUnlock(false)\r\n      }\r\n    }\r\n  }, [outputValueParsed, allowance, t])\r\n\r\n  const isActive = active && account\r\n  const isValid = (inputError === null || outputError === null) && !showUnlock\r\n\r\n  const allBalances = useFetchAllBalances()\r\n\r\n  return (\r\n    <>\r\n      {isNewExchange ? (\r\n        <NewExchangeWarning>\r\n          <NewExchangeWarningText>\r\n            <span role=\"img\" aria-label=\"first-liquidity\">\r\n              🚰\r\n            </span>{' '}\r\n            {t('firstLiquidity')}\r\n          </NewExchangeWarningText>\r\n          <NewExchangeWarningText>{t('initialExchangeRate', { symbol })}</NewExchangeWarningText>\r\n        </NewExchangeWarning>\r\n      ) : null}\r\n\r\n      <CurrencyInputPanel\r\n        title={t('deposit')}\r\n        allBalances={allBalances}\r\n        extraText={inputBalance && formatBalance(amountFormatter(inputBalance, 18, 4))}\r\n        onValueChange={inputValue => {\r\n          dispatchAddLiquidityState({ type: 'UPDATE_VALUE', payload: { value: inputValue, field: INPUT } })\r\n        }}\r\n        selectedTokenAddress=\"ETH\"\r\n        value={inputValue}\r\n        errorMessage={inputError}\r\n        disableTokenSelect\r\n      />\r\n      <OversizedPanel>\r\n        <DownArrowBackground>\r\n          <ColoredWrappedPlus active={isActive} alt=\"plus\" />\r\n        </DownArrowBackground>\r\n      </OversizedPanel>\r\n      <CurrencyInputPanel\r\n        title={t('deposit')}\r\n        allBalances={allBalances}\r\n        description={isNewExchange ? '' : outputValue ? `(${t('estimated')})` : ''}\r\n        extraText={outputBalance && formatBalance(amountFormatter(outputBalance, decimals, Math.min(decimals, 4)))}\r\n        selectedTokenAddress={outputCurrency}\r\n        onCurrencySelected={outputCurrency => {\r\n          dispatchAddLiquidityState({ type: 'SELECT_CURRENCY', payload: outputCurrency })\r\n        }}\r\n        onValueChange={outputValue => {\r\n          dispatchAddLiquidityState({ type: 'UPDATE_VALUE', payload: { value: outputValue, field: OUTPUT } })\r\n        }}\r\n        value={outputValue}\r\n        showUnlock={showUnlock}\r\n        errorMessage={outputError}\r\n      />\r\n      <OversizedPanel hideBottom>\r\n        <SummaryPanel>\r\n          <ExchangeRateWrapper>\r\n            <ExchangeRate>{t('exchangeRate')}</ExchangeRate>\r\n            <span>{marketRate ? `1 ETH = ${amountFormatter(marketRate, 18, 4)} ${symbol}` : ' - '}</span>\r\n          </ExchangeRateWrapper>\r\n          <ExchangeRateWrapper>\r\n            <ExchangeRate>{t('currentPoolSize')}</ExchangeRate>\r\n            <span>\r\n              {exchangeETHBalance && exchangeTokenBalance\r\n                ? `${amountFormatter(exchangeETHBalance, 18, 4)} ETH + ${amountFormatter(\r\n                    exchangeTokenBalance,\r\n                    decimals,\r\n                    Math.min(4, decimals)\r\n                  )} ${symbol}`\r\n                : ' - '}\r\n            </span>\r\n          </ExchangeRateWrapper>\r\n          <ExchangeRateWrapper>\r\n            <ExchangeRate>\r\n              {t('yourPoolShare')} ({exchangeETHBalance && amountFormatter(poolTokenPercentage, 16, 2)}%)\r\n            </ExchangeRate>\r\n            <span>\r\n              {ethShare && tokenShare\r\n                ? `${amountFormatter(ethShare, 18, 4)} ETH + ${amountFormatter(\r\n                    tokenShare,\r\n                    decimals,\r\n                    Math.min(4, decimals)\r\n                  )} ${symbol}`\r\n                : ' - '}\r\n            </span>\r\n          </ExchangeRateWrapper>\r\n        </SummaryPanel>\r\n      </OversizedPanel>\r\n      {renderSummary()}\r\n      <Flex>\r\n        <Button disabled={!isValid} onClick={onAddLiquidity}>\r\n          {t('addLiquidity')}\r\n        </Button>\r\n      </Flex>\r\n    </>\r\n  )\r\n}\r\n"],"sourceRoot":""}